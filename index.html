<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>BLINCHIGAMES | Elite Game Library</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=Space+Grotesk:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <!-- Google AdSense Main Script -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5157317095946191" crossorigin="anonymous"></script>

    <style>
        :root {
            --brand: #32ff0e;
            --brand-soft: rgba(50, 255, 14, 0.1);
            --bg-dark: #050505;
            --sidebar: #0b0b0b;
            --surface: #111111;
            --surface-hover: #1a1a1a;
            --text-main: #ffffff;
            --text-secondary: #888888;
            --font-main: 'Plus Jakarta Sans', sans-serif;
            --font-display: 'Space Grotesk', sans-serif;
            --radius-lg: 24px;
            --radius-md: 16px;
            --transition: cubic-bezier(0.4, 0, 0.2, 1);
        }

        body { 
            background: var(--bg-dark); 
            color: var(--text-main);
            font-family: var(--font-main);
            margin: 0;
            overflow-x: hidden;
        }

        /* --- LAYOUT STRUCTURE --- */
        .app-container { display: flex; min-height: 100vh; }

        /* Sidebar Menu */
        .sidebar {
            width: 280px;
            background: var(--sidebar);
            border-right: 1px solid rgba(255,255,255,0.05);
            height: 100vh;
            position: sticky;
            top: 0;
            display: flex;
            flex-direction: column;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar-header { padding: 30px 25px; }
        .logo { 
            font-family: var(--font-display); 
            font-size: 1.5rem; 
            font-weight: 800; 
            color: #fff; 
            text-decoration: none;
            letter-spacing: -1px;
        }
        .logo span { color: var(--brand); }

        .menu-scroll { flex: 1; overflow-y: auto; padding: 10px 15px; scrollbar-width: none; }
        .menu-scroll::-webkit-scrollbar { display: none; }

        .menu-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--text-secondary);
            font-weight: 800;
            margin: 25px 15px 10px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 18px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
        }
        .nav-item:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .nav-item.active { color: var(--brand); background: var(--brand-soft); }
        .nav-item i { font-size: 1.1rem; }

        /* Main Content */
        .main-content { flex: 1; min-width: 0; position: relative; }

        /* --- LOADING OVERLAY --- */
        #loading-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 2000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.6s ease;
        }

        /* Bouncy Animation for logo */
        .bouncy-logo {
            animation: bounce 0.8s infinite alternate;
        }
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-15px); }
        }

        /* --- AD SLOTS --- */
        .ad-container-top { padding: 20px; background: rgba(255,255,255,0.02); text-align: center; }
        .ad-sidebar-fixed { width: 160px; flex-shrink: 0; padding: 20px 0; }

        /* --- GAME CARDS --- */
        .game-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; padding: 20px; }
        .elite-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }

        .game-card {
            background: var(--surface);
            border-radius: var(--radius-md);
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s var(--transition);
            cursor: pointer;
            position: relative;
        }
        .game-card:hover { transform: translateY(-5px); border-color: var(--brand); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .game-thumb { aspect-ratio: 16/10; overflow: hidden; position: relative; }
        .game-thumb img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .game-card:hover .game-thumb img { transform: scale(1.1); }
        
        .game-info { padding: 12px; }
        .game-info h6 { margin: 0; font-size: 0.85rem; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .badge-elite { 
            position: absolute; top: 10px; left: 10px; background: var(--brand); color: #000;
            font-size: 0.6rem; font-weight: 900; padding: 3px 8px; border-radius: 4px; text-transform: uppercase;
        }

        /* --- STAGE --- */
        #game-stage { display: none; position: fixed; inset: 0; background: #000; z-index: 1500; }
        .stage-header { height: 60px; display: flex; align-items: center; padding: 0 20px; background: #111; border-bottom: 1px solid #222; }
        .stage-body { display: flex; height: calc(100vh - 60px); }
        .iframe-container { flex: 1; position: relative; background: #000; }
        #stage-iframe { width: 100%; height: 100%; border: none; }

        @media (max-width: 992px) {
            .sidebar { transform: translateX(-100%); position: fixed; }
            .sidebar.open { transform: translateX(0); }
        }
    </style>
</head>
<body>

<div id="loading-overlay">
    <div class="text-center">
        <h2 class="logo mb-4 bouncy-logo" style="font-size: 3rem;">BLINCHI<span>GAMES</span></h2>
        <div class="spinner-border text-success" role="status"></div>
        <p class="text-secondary mt-3 small opacity-50">Optimizing Engine...</p>
    </div>
</div>

<div class="app-container">
    <!-- SIDEBAR MENU -->
    <aside id="main-sidebar" class="sidebar">
        <div class="sidebar-header">
            <a href="#" class="logo" onclick="showSection('home')">BLINCHI<span>GAMES</span></a>
        </div>
        
        <div class="menu-scroll">
            <div class="menu-label">Featured</div>
            <button class="nav-item active" onclick="showSection('home')">
                <i class="bi bi-house-door"></i> Home
            </button>
            <button class="nav-item" onclick="showSection('elite')">
                <i class="bi bi-star-fill text-warning"></i> Elite Picks
            </button>

            <div class="menu-label">Library Menu</div>
            <div id="category-nav-list">
                <!-- Categories will be injected here -->
            </div>
            
            <div class="menu-label">Follow Us</div>
            <a href="https://www.tiktok.com/@blinchigames3?lang=en" target="_blank" class="nav-item text-decoration-none">
                <i class="bi bi-tiktok"></i> TikTok
            </a>
        </div>

        <div class="p-4 mt-auto">
            <div class="adsense-unit">
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5157317095946191" data-ad-slot="4832577246" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <!-- Top Ad Banner -->
        <div class="ad-container-top">
            <ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-5157317095946191" data-ad-slot="4832577246"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>

        <div id="view-home" class="view-section container-fluid py-4">
            <h2 class="section-title mb-4 font-display fw-bold text-uppercase italic"><i class="bi bi-lightning-charge-fill text-success"></i> Elite Collection</h2>
            <div id="elite-games-container" class="game-grid elite-grid mb-5">
                <!-- Constant games here -->
            </div>

            <h2 class="section-title mb-4 font-display fw-bold text-uppercase italic">Browse Library</h2>
            <div id="library-preview" class="game-grid">
                <!-- Catalog games here -->
            </div>
        </div>

        <div id="view-category" class="view-section container-fluid py-4" style="display:none">
            <h2 id="category-title" class="section-title mb-4 font-display fw-bold text-uppercase italic"></h2>
            <div id="category-games-container" class="game-grid"></div>
        </div>
    </main>
</div>

<!-- GAME STAGE -->
<div id="game-stage">
    <div class="stage-header">
        <button class="btn btn-dark btn-sm rounded-pill px-4 fw-bold me-3" onclick="closeGame()"><i class="bi bi-arrow-left"></i> Exit</button>
        <span id="active-game-title" class="fw-bold text-uppercase small tracking-widest text-secondary"></span>
    </div>
    <div class="stage-body">
        <aside class="ad-sidebar-fixed d-none d-xl-block">
             <ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-5157317095946191" data-ad-slot="4832577246"></ins>
             <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </aside>
        <div class="iframe-container">
            <iframe id="stage-iframe" src=""></iframe>
        </div>
        <aside class="ad-sidebar-fixed d-none d-xl-block">
            <ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-5157317095946191" data-ad-slot="8074246080"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </aside>
    </div>
</div>

<script>
    const eliteGames = [
        { id: 'wbwwb', title: 'We Become What We Behold', url: 'https://ncase.itch.io/wbwwb', thumb: 'https://img.itch.zone/aW1nLzU0NjEwNy5wbmc=/315x250%23c/yH%2F6pI.png' },
        { id: 'polytrack', title: 'PolyTrack', url: 'https://kodub.itch.io/polytrack', thumb: 'https://img.itch.zone/aW1nLzEwNjkzNTU4LnBuZw==/315x250%23c/4v09eA.png' },
        { id: 'poom', title: 'POOM', url: 'https://freds72.itch.io/poom', thumb: 'https://img.itch.zone/aW1nLzM5MjY3OTkucG5n/315x250%23c/0RjS5Q.png' },
        { id: 'gunknight', title: 'Gun Knight', url: 'https://stepford.itch.io/gun-knight', thumb: 'https://img.itch.zone/aW1nLzI3ODc5MzMucG5n/315x250%23c/1X%2BR8S.png' },
        { id: 'captchaware', title: 'CaptchaWare', url: 'https://paperhatprojects.itch.io/captchaware', thumb: 'https://img.itch.zone/aW1nLzE3Njg1NDUyLnBuZw==/315x250%23c/9f%2BFuB.png' },
        { id: 'speedstars', title: 'Speed Stars 2', url: 'https://speedstars2.io/', thumb: 'https://img.gamemonetize.com/9hibl9blop3ss2jxycuxpzoflnl2n16w/512x384.jpg' }
    ];

    let fullCatalog = [];
    let backgroundPointer = 0;
    const CHUNK_SIZE = 100;
    const BACKGROUND_LOAD_INTERVAL = 20000; // 20 seconds
    const feeds = ['rssfeed.php.json', 'rssfeed2.php', 'rssfeed3.php', 'rssfeed4.php', 'rssfeed5.php'];

    async function init() {
        // Render Elite Games first
        const eliteContainer = document.getElementById('elite-games-container');
        eliteGames.forEach(g => {
            eliteContainer.innerHTML += createCardHTML(g, true);
        });

        // Load Catalog Metadata
        const fetchPromises = feeds.map(url => fetch(url).then(r => r.json()).catch(() => []));
        const results = await Promise.all(fetchPromises);
        
        results.forEach(data => {
            if (Array.isArray(data)) {
                data.forEach(g => {
                    if (g && g.id) fullCatalog.push(g);
                });
            }
        });

        // 1. Load HALF of the games immediately during the bouncy screen
        const halfCount = Math.floor(fullCatalog.length / 2);
        renderInitialBatch(halfCount);
        
        // 2. Setup background loader for the rest
        backgroundPointer = halfCount;
        startBackgroundLoader();

        renderMenu();
        
        // Hide Loader
        setTimeout(() => {
            document.getElementById('loading-overlay').style.opacity = '0';
            setTimeout(() => document.getElementById('loading-overlay').style.display = 'none', 600);
        }, 1500); // Slightly longer for the "bouncy" effect
    }

    function renderInitialBatch(count) {
        const container = document.getElementById('library-preview');
        const batch = fullCatalog.slice(0, count);
        
        // Use requestAnimationFrame to avoid freezing the main thread during heavy DOM insertion
        let i = 0;
        function step() {
            const nextBatch = batch.slice(i, i + 50);
            if (nextBatch.length > 0) {
                let html = '';
                nextBatch.forEach(g => html += createCardHTML(g));
                container.insertAdjacentHTML('beforeend', html);
                i += 50;
                requestAnimationFrame(step);
            }
        }
        requestAnimationFrame(step);
    }

    function startBackgroundLoader() {
        setInterval(() => {
            if (backgroundPointer < fullCatalog.length) {
                const container = document.getElementById('library-preview');
                const chunk = fullCatalog.slice(backgroundPointer, backgroundPointer + CHUNK_SIZE);
                
                let html = '';
                chunk.forEach(g => html += createCardHTML(g));
                container.insertAdjacentHTML('beforeend', html);
                
                backgroundPointer += CHUNK_SIZE;
                console.log(`Background Loader: Loaded up to ${backgroundPointer} games.`);
            }
        }, BACKGROUND_LOAD_INTERVAL);
    }

    function renderMenu() {
        const menu = document.getElementById('category-nav-list');
        const cats = [...new Set(fullCatalog.map(g => (g.category || 'Arcade').split(',')[0].trim()))].sort();
        
        cats.forEach(cat => {
            const btn = document.createElement('button');
            btn.className = 'nav-item';
            btn.innerHTML = `<i class="bi bi-folder2"></i> ${cat}`;
            btn.onclick = () => showCategory(cat);
            menu.appendChild(btn);
        });
    }

    function createCardHTML(game, isElite = false) {
        return `
            <div class="game-card" onclick="openGame('${game.url}', '${game.title}')">
                <div class="game-thumb">
                    ${isElite ? '<div class="badge-elite">Elite</div>' : ''}
                    <img src="${game.thumb}" alt="${game.title}" loading="lazy">
                </div>
                <div class="game-info">
                    <h6>${game.title}</h6>
                </div>
            </div>
        `;
    }

    function showSection(section) {
        document.querySelectorAll('.view-section').forEach(v => v.style.display = 'none');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        
        if(section === 'home') {
            document.getElementById('view-home').style.display = 'block';
            document.querySelector('[onclick="showSection(\'home\')"]').classList.add('active');
        }
    }

    function showCategory(cat) {
        document.querySelectorAll('.view-section').forEach(v => v.style.display = 'none');
        const view = document.getElementById('view-category');
        const container = document.getElementById('category-games-container');
        const title = document.getElementById('category-title');
        
        view.style.display = 'block';
        title.innerHTML = `<i class="bi bi-folder2-open text-success"></i> ${cat}`;
        container.innerHTML = '';
        
        const filtered = fullCatalog.filter(g => (g.category || 'Arcade').includes(cat));
        filtered.forEach(g => container.innerHTML += createCardHTML(g));
        window.scrollTo(0,0);
    }

    function openGame(url, title) {
        document.getElementById('game-stage').style.display = 'block';
        document.getElementById('stage-iframe').src = url;
        document.getElementById('active-game-title').innerText = `Playing: ${title}`;
    }

    function closeGame() {
        document.getElementById('game-stage').style.display = 'none';
        document.getElementById('stage-iframe').src = '';
    }

    window.addEventListener('load', init);
</script>

</body>
</html>
